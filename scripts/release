#!/usr/bin/env bash
# SPDX-License-Identifier: MPL-2.0
set -euo pipefail

SCRIPT_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"
# shellcheck source=scripts/_helpers.sh
source "$SCRIPT_DIR/_helpers.sh"

ensure_venv

DRY_RUN="false"
for arg in "$@"; do
  if [[ "$arg" == "--dry-run" ]]; then
    DRY_RUN="true"
  fi
done

with_env in_venv cz bump "$@"

if [[ "$DRY_RUN" == "false" ]]; then
  "$SCRIPT_DIR/build"
  "$SCRIPT_DIR/sbom"
fi
